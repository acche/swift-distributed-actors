{"seeAlsoSections":[{"title":"Articles","identifiers":["doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Introduction","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Clustering","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Lifecycle","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Receptionist","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Security","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Observability"],"generated":true}],"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingleton"}],"title":"ClusterSingleton","roleHeading":"Protocol","role":"symbol","symbolKind":"protocol","externalID":"s:18DistributedCluster0B9SingletonP","modules":[{"name":"DistributedCluster"}],"navigatorTitle":[{"kind":"identifier","text":"ClusterSingleton"}]},"abstract":[{"type":"text","text":"A "},{"type":"emphasis","inlineContent":[{"type":"text","text":"cluster singleton"}]},{"type":"text","text":" is a conceptual distributed actor that is guaranteed to have at-most one"},{"type":"text","text":" "},{"type":"text","text":"instance within the cluster system among all of its "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Cluster\/MemberStatus\/up"},{"type":"text","text":" members."}],"sections":[],"identifier":{"url":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton","interfaceLanguage":"swift"},"relationshipsSections":[{"identifiers":["doc:\/\/DistributedCluster\/11Distributed0A5ActorP","doc:\/\/DistributedCluster\/SQ","doc:\/\/DistributedCluster\/SH","doc:\/\/DistributedCluster\/s12IdentifiableP","doc:\/\/DistributedCluster\/s8SendableP","doc:\/\/DistributedCluster\/12_Concurrency8AnyActorP"],"kind":"relationships","title":"Inherits From","type":"inheritsFrom"}],"hierarchy":{"paths":[["doc:\/\/DistributedCluster\/documentation\/DistributedCluster"]]},"topicSections":[{"title":"Essentials","identifiers":["doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonSettings"]},{"title":"Configuring Singleton Allocation Strategies","identifiers":["doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategySettings"]},{"title":"Implementing a custom Singleton Allocation Strategy","identifiers":["doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategy","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationByLeadership"]},{"title":"Instance Methods","identifiers":["doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/activateSingleton()-646gy","doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/passivateSingleton()-8o2r0"]}],"variants":[{"paths":["\/documentation\/distributedcluster\/clustersingleton"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"symbol","primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingleton"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","text":"DistributedActor","preciseIdentifier":"s:11Distributed0A5ActorP"},{"kind":"text","text":" "},{"kind":"keyword","text":"where"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"Self"},{"kind":"text","text":"."},{"kind":"typeIdentifier","text":"ActorSystem"},{"kind":"text","text":" == "},{"kind":"typeIdentifier","identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSystem","preciseIdentifier":"s:18DistributedCluster0B6SystemC","text":"ClusterSystem"}],"languages":["swift"],"platforms":["macOS"]}]},{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This guarantee does not extend to "},{"type":"emphasis","inlineContent":[{"type":"text","text":"down"}]},{"type":"text","text":" members, because a down member is not part of the cluster anymore."}]}],"type":"aside","name":"Note"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To create a managed singleton you must use the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin"},{"type":"text","text":","},{"type":"text","text":" "},{"type":"text","text":"and have the instantiation and lifecycle of the actor be managed by the plugin."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To host a distributed cluster singleton, use the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin\/host(_:name:settings:makeInstance:)"},{"type":"text","text":" method."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Allows for hosting a "},{"type":"emphasis","inlineContent":[{"type":"text","text":"single unique instance"}]},{"type":"text","text":" of a distributed actor within the entire distributed actor system,"},{"type":"text","text":" "},{"type":"text","text":"including automatic fail-over when the node hosting the instance becomes down."}]},{"anchor":"Implementing-a-Cluster-Singleton","level":3,"type":"heading","text":"Implementing a Cluster Singleton"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A cluster singleton is a distributed actor using the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSystem"},{"type":"text","text":" actor system and conforming to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton"},{"type":"text","text":" protocol."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We can implement a singleton by declaring a "},{"type":"codeVoice","code":"distributed actor"},{"type":"text","text":" as follows:"}]},{"type":"codeListing","syntax":"swift","code":["import DistributedCluster","typealias DefaultDistributedActorSystem = ClusterSystem"]},{"type":"codeListing","syntax":"swift","code":["distributed actor PrimaryOverseer: ClusterSingleton {","  var status = WorkStatus()","","  distributed func workStatus() -> WorkStatus { ","    self.status","  }","}","","distributed actor Worker { \/* ... *\/ }","","struct WorkStatus: Codable { ","  var workerCapacity: Int = 0","  var workInProgress: Int = 0","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The protocol does not have any protocol requirements that are required to be implemented explicitly, however it allows the runtime to inform the singleton instance about important events regarding its lifecycle."}]},{"anchor":"Obtaining-Cluster-Singleton-references","level":3,"type":"heading","text":"Obtaining Cluster Singleton references"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To use singletons in your system you must enable the singleton plugin first:"}]},{"type":"codeListing","syntax":"swift","code":["let system = await ClusterSystem(\"SingletonExample\") { settings in","  settings.plugins.install(plugin: ClusterSingletonPlugin())","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Next, you’ll be able to make use of the "},{"type":"codeVoice","code":".singleton"},{"type":"text","text":" property on the cluster system to perform various actions on the active plugin."},{"type":"text","text":" "},{"type":"text","text":"Most importantly, you can issue a "},{"type":"codeVoice","code":"host"},{"type":"text","text":" call, in order to inform the singleton boss that this node is capable of hosting the given singleton:"}]},{"type":"codeListing","syntax":"swift","code":["let overseerSingleton: PrimaryOverseer =    ","  try await system.singleton.host(name: \"overseer\") { actorSystem in ","    PrimaryOverseer(actorSystem: actorSystem)","  }"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The passed "},{"type":"codeVoice","code":"name"},{"type":"text","text":" is the unique name that the singleton shall be identified with in the cluster. In other words, since we’ve given this singleton the name "},{"type":"codeVoice","code":"\"overseer\""},{"type":"text","text":", there will be always at-most-one "},{"type":"codeVoice","code":"\"overseer\""},{"type":"text","text":" actor instance active in the cluster. This allows us to have multiple singletons of the same actor type, but different identities. For example, we could have a "},{"type":"codeVoice","code":"\"simple-work-overseer\""},{"type":"text","text":" and a "},{"type":"codeVoice","code":"\"complicated-work-overseer\""},{"type":"text","text":" singleton running side-by-side. Conceptually, they are different singletons after all, and we can use them differently."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"A "},{"type":"codeVoice","code":"PrimaryOverseer"},{"type":"text","text":" obtained this way is actually a proxy that will redirect calls made on it to wherever the actual singleton instance is currently hosted."},{"type":"text","text":" "},{"type":"text","text":"This includes the local cluster member, in case that is where the singleton ends up "},{"type":"emphasis","inlineContent":[{"type":"text","text":"allocated"}]},{"type":"text","text":" (see: <doc#. From the perspective of the caller though, the location of the singleton remains transparent - with the benefit that if the calls are actually remote, they don’t have to cross a network boundary and will be more efficient. We should not rely on this though, and we should program against the singleton as-if it might be remote since its location might be changing at runtime."}]},{"anchor":"Making-calls-to-Cluster-Singletons","level":3,"type":"heading","text":"Making calls to Cluster Singletons"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Making calls to cluster singletons looks the same as calls to any other distributed actor:"}]},{"type":"codeListing","syntax":"swift","code":["func obtainStatus(from overseer: PrimaryOverseer) async throws { ","  let status = try await overseer.workStatus() ","  print(\"Work status: \\(status)\")","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Even more interestingly, since the type returned by "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin\/host(_:name:settings:makeInstance:)"},{"type":"text","text":" is the exact same type as the target actor,"},{"type":"text","text":" "},{"type":"text","text":"it is possible to pass a local "},{"type":"codeVoice","code":"PrimaryOverseer"},{"type":"text","text":" instance directly when testing methods working with it, even though in a deployed system it would be a cluster singleton:"}]},{"type":"codeListing","syntax":"swift","code":["func test_theTestFunction() async throws {","  let overseer = PrimaryOverseer(actorSystem: system)","  try await obtainStatus(from: overseer)","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Such a proxied call to a distributed actor can take one of three general paths showcased on the diagram below, that we’ll explain in depth:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"cluster_singleton_calls.png"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"(a)"}]},{"type":"text","text":" A call from a freshly joined cluster "},{"type":"emphasis","inlineContent":[{"type":"text","text":"member which does not yet know where the singleton is currently hosted"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Such calls will be buffered by the proxy on the calling side, while it determines the location of the singleton instance."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"As the instance is located, the calls are flushed and delivered to the instance on node "},{"type":"codeVoice","code":"\"A\""},{"type":"text","text":"."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If no instance is located within the allocation timeout, or the calls timeout themselves, the calls fail and are dropped from the singleton proxy’s buffer."}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"(b)"}]},{"type":"text","text":" A call from a member which has "},{"type":"emphasis","inlineContent":[{"type":"text","text":"already discovered where the singleton is hosted"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Such calls are directly forwarded without any buffering, and only incur a minimal extra local call cost when performing the forwarding to the target instance on "},{"type":"codeVoice","code":"\"A\""},{"type":"text","text":"."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Note:"}]},{"type":"text","text":" This is how all subsequent calls in the (a) scenario are handled, once the singleton has been located and initial messages have been flushed."}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"(c)"}]},{"type":"text","text":" A call on a member which does actually host the singleton instance itself:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Such calls are directly delivered to the local instance."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Note:"}]},{"type":"text","text":" Thanks to location transparency ensured by the "},{"type":"codeVoice","code":"distributed actor"},{"type":"text","text":" returned by the "},{"type":"codeVoice","code":"singleton.host(...)"},{"type":"text","text":" call, even if the singleton were to move to another node, the callers from this node don’t need to care or change anything – we still are programming against a location transparent conceptual singleton, even though it happens to be running locally."}]}]}]}]}]},{"anchor":"Allocation-Strategies","level":3,"type":"heading","text":"Allocation Strategies"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The lifecycle of a cluster singleton is managed by the plugin, and not explicitly by the developer."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"emphasis","inlineContent":[{"type":"text","text":"allocation"}]},{"type":"text","text":" of a singleton within a cluster consists of actually creating a new "},{"type":"emphasis","inlineContent":[{"type":"text","text":"instance"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"activating"}]},{"type":"text","text":" it - by calling the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/activateSingleton()-9fbad"},{"type":"text","text":" method. Which member of the cluster is to perform this allocation is determined automatically at runtime, based on the state of the cluster, and is determined by the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategySettings"},{"type":"text","text":" as configured for the singleton."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The default allocation strategy is "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategySettings\/byLeadership"},{"type":"text","text":" meaning that a singleton is going to be allocated on the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"leader"}]},{"type":"text","text":" node of the cluster."}]},{"style":"tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This also means that all singletons in a cluster by default share the same node they run on. This may be sup-optimal in some scenarios, and can be customized by providing a custom allocation strategy, or in the future more advanced strategies will be offered by the library."}]}],"type":"aside","name":"Tip"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Picking an allocation strategy is made by customizing the settings passed to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin\/host(_:name:settings:makeInstance:)"},{"type":"text","text":" method, like this:"}]},{"type":"codeListing","syntax":"swift","code":["@Sendable","func makeCustomAllocationStrategy(","        settings: ClusterSingletonSettings, ","        system: ClusterSystem) async -> CustomSingletonAllocationStrategy {","    CustomSingletonAllocationStrategy()","}","","var bossSingletonSettings = ClusterSingletonSettings()","bossSingletonSettings.allocationStrategy = .custom(makeCustomAllocationStrategy)","","let boss = try await system.singleton.host(name: \"boss\", settings: bossSingletonSettings) { system in  ","  Boss(actorSystem: system)","}","","actor CustomSingletonAllocationStrategy: ClusterSingletonAllocationStrategy {","    func onClusterEvent(_ clusterEvent: Cluster.Event) async -> Cluster.Node? {","        fatalError()","    }","","    var node: Cluster.Node? { ","        get async {","            fatalError()","        }","    }","}","","distributed actor Boss: ClusterSingleton { \/* ... *\/ }"]},{"anchor":"Singleton-Lifecycle","level":3,"type":"heading","text":"Singleton Lifecycle"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A singleton instance is created and retained (!) by the singleton plugin when the allocation strategy decides the member should be hosting it."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The allocated singleton instance will get the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/activateSingleton()-9fbad"},{"type":"text","text":" method called before any further calls are delivered to it."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Conversely, when the allocation strategy decides that this cluster member is no longer hosting the singleton the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/passivateSingleton()-31z1s"},{"type":"text","text":" method will be invoked and the actor will be released. Make sure to not retain the actor or make it perform any decisions which require single-point-of-truth after it has had passivate called on it, as it no longer is guaranteed to be the unique singleton instance anymore."}]},{"anchor":"Glossary","level":2,"type":"heading","text":"Glossary"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"cluster singleton"}]},{"type":"text","text":" - the conceptual “singleton”. Regardless on which node it is located we can generally speak in terms of contacting the cluster singleton, by which we mean contacting a concrete active instance, wherever it is currently allocated."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"singleton "},{"type":"strong","inlineContent":[{"type":"text","text":"instance"}]},{"type":"text","text":" - a concrete instance of a distributed actor, allocated as a singleton. In contrast to “cluster singleton”, a “cluster singleton instance” refers to a concrete unique instance on a concrete unique member in the cluster."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"singleton "},{"type":"strong","inlineContent":[{"type":"text","text":"allocation"}]},{"type":"text","text":" - the act of “allocating” a singleton is the decision about on which member it should be running right now, and that member starting the actor instance on-demand."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"host"}]},{"type":"text","text":" a singleton - the act (or ability) of a cluster member running an active instance of a singleton."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"singleton "},{"type":"strong","inlineContent":[{"type":"text","text":"proxy"}]},{"type":"text","text":" - the local interface through which all interactions with a singleton are performed. Calls to a singleton, regardless if local or remote, are always performed through the proxy, which handles the decision where to the calls shall be forwarded to."}]}]}]}]}],"references":{"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonAllocationStrategySettings":{"role":"symbol","title":"ClusterSingletonAllocationStrategySettings","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingletonAllocationStrategySettings"}],"abstract":[{"type":"text","text":"Singleton node allocation strategies."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategySettings","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingletonAllocationStrategySettings"}],"url":"\/documentation\/distributedcluster\/clustersingletonallocationstrategysettings"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingleton":{"role":"symbol","title":"ClusterSingleton","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingleton"}],"abstract":[{"type":"text","text":"A "},{"type":"emphasis","inlineContent":[{"type":"text","text":"cluster singleton"}]},{"type":"text","text":" is a conceptual distributed actor that is guaranteed to have at-most one"},{"type":"text","text":" "},{"type":"text","text":"instance within the cluster system among all of its "},{"type":"reference","isActive":true,"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Cluster\/MemberStatus\/up"},{"type":"text","text":" members."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingleton"}],"url":"\/documentation\/distributedcluster\/clustersingleton"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingleton/activateSingleton()-9fbad":{"role":"symbol","title":"activateSingleton()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"activateSingleton"},{"kind":"text","text":"() "},{"kind":"keyword","text":"async"}],"abstract":[],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/activateSingleton()-9fbad","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster\/clustersingleton\/activatesingleton()-9fbad"},"doc://DistributedCluster/documentation/DistributedCluster/Security":{"role":"article","title":"Security","abstract":[{"type":"text","text":"Configuring security aspects of your cluster system."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Security","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/security"},"doc://DistributedCluster/s8SendableP":{"type":"unresolvable","title":"Swift.Sendable","identifier":"doc:\/\/DistributedCluster\/s8SendableP"},"doc://DistributedCluster/SQ":{"type":"unresolvable","title":"Swift.Equatable","identifier":"doc:\/\/DistributedCluster\/SQ"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonPlugin/host(_:name:settings:makeInstance:)":{"role":"symbol","title":"host(_:name:settings:makeInstance:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"host"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"Act"},{"kind":"text","text":">("},{"kind":"typeIdentifier","text":"Act"},{"kind":"text","text":".Type, "},{"kind":"externalParam","text":"name"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":", "},{"kind":"externalParam","text":"settings"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ClusterSingletonSettings","preciseIdentifier":"s:18DistributedCluster0B17SingletonSettingsV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"makeInstance"},{"kind":"text","text":": (("},{"kind":"typeIdentifier","text":"ClusterSystem","preciseIdentifier":"s:18DistributedCluster0B6SystemC"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Act"},{"kind":"text","text":")?) "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Act"}],"abstract":[{"type":"text","text":"Configures the singleton plugin to host instances of this actor."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin\/host(_:name:settings:makeInstance:)","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster\/clustersingletonplugin\/host(_:name:settings:makeinstance:)"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingleton/passivateSingleton()-31z1s":{"role":"symbol","title":"passivateSingleton()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"passivateSingleton"},{"kind":"text","text":"() "},{"kind":"keyword","text":"async"}],"abstract":[],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/passivateSingleton()-31z1s","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster\/clustersingleton\/passivatesingleton()-31z1s"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonPlugin":{"role":"symbol","title":"ClusterSingletonPlugin","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingletonPlugin"}],"abstract":[{"type":"codeVoice","code":"ClusterSingletonPlugin"},{"type":"text","text":" ensures that there is no more than one instance of a distributed actor running in the cluster."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonPlugin","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingletonPlugin"}],"url":"\/documentation\/distributedcluster\/clustersingletonplugin"},"doc://DistributedCluster/11Distributed0A5ActorP":{"type":"unresolvable","title":"Distributed.DistributedActor","identifier":"doc:\/\/DistributedCluster\/11Distributed0A5ActorP"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSystem":{"role":"symbol","title":"ClusterSystem","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSystem"}],"abstract":[{"type":"text","text":"A "},{"type":"codeVoice","code":"ClusterSystem"},{"type":"text","text":" is a confined space which runs and manages Actors."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSystem","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSystem"}],"url":"\/documentation\/distributedcluster\/clustersystem"},"doc://DistributedCluster/documentation/DistributedCluster/Introduction":{"role":"article","title":"Introducing Distributed Actors","abstract":[{"type":"text","text":"A high-level introduction to distributed actor systems."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Introduction","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/introduction"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonAllocationByLeadership":{"role":"symbol","title":"ClusterSingletonAllocationByLeadership","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingletonAllocationByLeadership"}],"abstract":[{"type":"text","text":"An "},{"type":"codeVoice","code":"AllocationStrategy"},{"type":"text","text":" in which selection is based on cluster leadership."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationByLeadership","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingletonAllocationByLeadership"}],"url":"\/documentation\/distributedcluster\/clustersingletonallocationbyleadership"},"doc://DistributedCluster/documentation/DistributedCluster/Observability":{"role":"article","title":"Observability","abstract":[{"type":"text","text":"The cluster system offers a number of built-in observability capabilities about the state of the cluster, as well as distributed actors it manages."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Observability","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/observability"},"doc://DistributedCluster/documentation/DistributedCluster/Cluster/MemberStatus/up":{"role":"symbol","title":"Cluster.MemberStatus.up","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"up"}],"abstract":[{"type":"text","text":"Describes a node which at some point was known to the leader and moved to "},{"type":"codeVoice","code":".up"},{"type":"text","text":" "},{"type":"text","text":"by whichever strategy it implements for this. Generally, up members are fully ready"},{"type":"text","text":" "},{"type":"text","text":"members of the cluster and are most likely known to many if not all other nodes in the cluster."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Cluster\/MemberStatus\/up","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster\/cluster\/memberstatus\/up"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingleton/activateSingleton()-646gy":{"defaultImplementations":1,"role":"symbol","title":"activateSingleton()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"activateSingleton"},{"kind":"text","text":"() "},{"kind":"keyword","text":"async"}],"abstract":[{"type":"text","text":"The singleton is now active, and should perform its duties."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/activateSingleton()-646gy","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/distributedcluster\/clustersingleton\/activatesingleton()-646gy"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonSettings":{"role":"symbol","title":"ClusterSingletonSettings","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingletonSettings"}],"abstract":[{"type":"text","text":"Settings for a "},{"type":"codeVoice","code":"ClusterSingleton"},{"type":"text","text":"."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonSettings","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingletonSettings"}],"url":"\/documentation\/distributedcluster\/clustersingletonsettings"},"doc://DistributedCluster/12_Concurrency8AnyActorP":{"type":"unresolvable","title":"_Concurrency.AnyActor","identifier":"doc:\/\/DistributedCluster\/12_Concurrency8AnyActorP"},"doc://DistributedCluster/documentation/DistributedCluster":{"role":"collection","title":"DistributedCluster","abstract":[{"type":"text","text":"A peer-to-peer cluster actor system implementation for Swift."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster"},"cluster_singleton_calls.png":{"alt":"Diagram showing three nodes, all making calls to the singleton; (a) this node does not know yet where the singleton instance is (b) this node already knows where the singleton is and (c) this node knows that it is hosting the singleton, so the calls are local","type":"image","identifier":"cluster_singleton_calls.png","variants":[{"url":"\/images\/cluster_singleton_calls.png","traits":["1x","light"]}]},"doc://DistributedCluster/documentation/DistributedCluster/Clustering":{"role":"article","title":"Clustering","abstract":[{"type":"text","text":"Clustering multiple actor system instances into a single Distributed Actor System."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Clustering","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/clustering"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonAllocationStrategy":{"role":"symbol","title":"ClusterSingletonAllocationStrategy","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"ClusterSingletonAllocationStrategy"}],"abstract":[{"type":"text","text":"Strategy for choosing a "},{"type":"codeVoice","code":"Cluster.Node"},{"type":"text","text":" to allocate singleton."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategy","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ClusterSingletonAllocationStrategy"}],"url":"\/documentation\/distributedcluster\/clustersingletonallocationstrategy"},"doc://DistributedCluster/s12IdentifiableP":{"type":"unresolvable","title":"Swift.Identifiable","identifier":"doc:\/\/DistributedCluster\/s12IdentifiableP"},"doc://DistributedCluster/documentation/DistributedCluster/Receptionist":{"role":"article","title":"Receptionist","abstract":[{"type":"text","text":"Discovering actors is an important aspect of distributed programming, as it is "},{"type":"emphasis","inlineContent":[{"type":"text","text":"the"}]},{"type":"text","text":" primary way we can discover actors on other nodes,"},{"type":"text","text":" "},{"type":"text","text":"and communicate with them."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Receptionist","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/receptionist"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingleton/passivateSingleton()-8o2r0":{"defaultImplementations":1,"role":"symbol","title":"passivateSingleton()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"passivateSingleton"},{"kind":"text","text":"() "},{"kind":"keyword","text":"async"}],"abstract":[{"type":"text","text":"The singleton should no longer be active on this cluster member."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingleton\/passivateSingleton()-8o2r0","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/distributedcluster\/clustersingleton\/passivatesingleton()-8o2r0"},"doc://DistributedCluster/SH":{"type":"unresolvable","title":"Swift.Hashable","identifier":"doc:\/\/DistributedCluster\/SH"},"doc://DistributedCluster/documentation/DistributedCluster/Lifecycle":{"role":"article","title":"Lifecycle Monitoring","abstract":[{"type":"text","text":"Monitoring distributed actor lifecycles regardless of their location."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/Lifecycle","kind":"article","type":"topic","url":"\/documentation\/distributedcluster\/lifecycle"},"doc://DistributedCluster/documentation/DistributedCluster/ClusterSingletonAllocationStrategySettings/byLeadership":{"role":"symbol","title":"byLeadership","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"let"},{"kind":"text","text":" "},{"kind":"identifier","text":"byLeadership"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"ClusterSingletonAllocationStrategySettings","preciseIdentifier":"s:18DistributedCluster0B35SingletonAllocationStrategySettingsV"}],"abstract":[{"type":"text","text":"Singletons will run on the cluster leader. "},{"type":"emphasis","inlineContent":[{"type":"text","text":"All"}]},{"type":"text","text":" nodes are potential candidates."}],"identifier":"doc:\/\/DistributedCluster\/documentation\/DistributedCluster\/ClusterSingletonAllocationStrategySettings\/byLeadership","kind":"symbol","type":"topic","url":"\/documentation\/distributedcluster\/clustersingletonallocationstrategysettings\/byleadership"}}}